{"version":3,"sources":["../../src/slideshow/slideshowPane.js"],"names":["UI","require","ns","makeBSS","module","exports","icon","icons","iconBase","name","audience","solid","label","subject","context","kb","session","store","t","findTypeURIs","ldp","uri","contents","each","count","forEach","file","widgets","isImage","render","dom","styleSheet","addStyleSheet","div","createElement","setAttribute","predicate","images","sort","i","length","figure","appendChild","img","options","setTimeout"],"mappings":"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","sourcesContent":["/*   slideshow Pane\n **\n */\nconst UI = require('solid-ui')\nconst ns = UI.ns\n\n// tabulator.loadScript(\"js/panes/slideshow/better-simple-slideshow/js/better-simple-slideshow.js\")\n\nconst makeBSS = require('@solid/better-simple-slideshow')\n// load also js/panes/slideshow/better-simple-slideshow/css/simple-slideshow-styles.css\n\nmodule.exports = {\n  icon: UI.icons.iconBase + 'noun_138712.svg',\n\n  name: 'slideshow',\n\n  audience: [ns.solid('PowerUser')],\n\n  // Does the subject deserve an slideshow pane?\n  label: function (subject, context) {\n    const kb = context.session.store\n    const ns = UI.ns\n    const t = kb.findTypeURIs(subject)\n    if (t[ns.ldp('Container').uri] || t[ns.ldp('BasicContainer').uri]) {\n      const contents = kb.each(subject, ns.ldp('contains'))\n      let count = 0\n      contents.forEach(function (file) {\n        if (UI.widgets.isImage(file)) count++\n      })\n      return count > 0 ? 'Slideshow' : null\n    }\n    return null\n  },\n\n  // See https://github.com/leemark/better-simple-slideshow\n  // and follow instructions there\n  render: function (subject, context) {\n    const dom = context.dom\n    const styleSheet =\n      'https://leemark.github.io/better-simple-slideshow/css/simple-slideshow-styles.css'\n    UI.widgets.addStyleSheet(dom, styleSheet)\n\n    const kb = context.session.store\n    const ns = UI.ns\n    const div = dom.createElement('div')\n    div.setAttribute('class', 'bss-slides')\n\n    const t = kb.findTypeURIs(subject)\n    let predicate\n    if (t[ns.ldp('BasicContainer').uri] || t[ns.ldp('Container').uri]) {\n      predicate = ns.ldp('contains')\n    }\n    const images = kb.each(subject, predicate) // @@ random order?\n    // @@ Ideally: sort by embedded time of image\n    images.sort() // Sort for now by URI\n    for (let i = 0; i < images.length; i++) {\n      if (!UI.widgets.isImage(images[i])) continue\n      const figure = div.appendChild(dom.createElement('figure'))\n      const img = figure.appendChild(dom.createElement('img'))\n      img.setAttribute('src', images[i].uri)\n      img.setAttribute('width', '100%')\n      figure.appendChild(dom.createElement('figcaption'))\n    }\n    const options = { dom: dom }\n\n    setTimeout(function () {\n      makeBSS('.bss-slides', options)\n    }, 1000) // Must run after the code which called this\n\n    return div\n  }\n}\n\n// ends\n"],"file":"slideshowPane.js"}