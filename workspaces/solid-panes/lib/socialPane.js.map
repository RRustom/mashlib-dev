{"version":3,"sources":["../src/socialPane.js"],"names":["UI","require","$rdf","module","exports","icon","icons","originalIconBase","name","label","subject","context","kb","session","store","types","findTypeURIs","ns","foaf","uri","vcard","render","s","dom","common","x","y","both","i","length","j","sameTerm","push","people","n","res","say","str","console","log","p","createElement","textContent","tips","appendChild","link","contents","a","setAttribute","text","createTextNode","buildCheckboxForm","lab","statement","state","f","input","tx","className","boxHandler","_e","checked","outliner","UserInput","sparqler","insert_statement","success","errorBody","alert","add","predicate","object","why","e","error","delete_statement","removeMany","addEventListener","oneFriend","friend","_confirmed","widgets","personTR","getOutliner","div","navBlockStyle","mainBlockStyle","foafPicStyle","structure","tr","left","middle","right","tools","style","cssText","mainTable","src","any","img","anyValue","h3","me","authn","currentUser","meUri","loginOutButton","loginStatusBox","webIdUri","sym","refreshTree","thisIsYou","sameThings","knows","familiar","friends","each","profile","editable","works","undefined","message","whether","rdf","utils","escapeForXML","cme","canon","incoming","outgoing","outgoingSt","statementsMatching","youAndThem","Statement","myFriends","mutualFriends","attachmentList","doc","modify","noun","triageFriends","confirmed","unconfirmed","requests","found","cases","thisCase","htr","items","j9","sort","last","fr","j7","keepThisCodeForLaterButDisableFerossConstantConditionPolice","preds","i6","pred","sts","uris","j5","st","last2","lab2","k","hostlabel","l","indexOf","r","r2","lastIndexOf","slice","t","d","preds2","i2","sts2","appendPropertyTRs","_pred"],"mappings":"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","sourcesContent":["/*   Social Pane\n **\n **  This outline pane provides social network functions\n **  Using for example the FOAF ontology.\n **  Goal:  A *distributed* version of facebook, advogato, etc etc\n **  - Similarly easy user interface, but data storage distributed\n **  - Read and write both user-private (address book) and public data clearly\n **  -- todo: use common code to get username and load profile and set 'me'\n */\n\nconst UI = require('solid-ui')\nconst $rdf = require('rdflib')\n\nmodule.exports = {\n  icon: UI.icons.originalIconBase + 'foaf/foafTiny.gif',\n\n  name: 'social',\n\n  label: function (subject, context) {\n    const kb = context.session.store\n    const types = kb.findTypeURIs(subject)\n    if (\n      types[UI.ns.foaf('Person').uri] ||\n      types[UI.ns.vcard('Individual').uri]\n    ) {\n      return 'Friends'\n    }\n    return null\n  },\n\n  render: function (s, context) {\n    const dom = context.dom\n    const common = function (x, y) {\n      // Find common members of two lists\n      const both = []\n      for (let i = 0; i < x.length; i++) {\n        for (let j = 0; j < y.length; j++) {\n          if (y[j].sameTerm(x[i])) {\n            both.push(y[j])\n            break\n          }\n        }\n      }\n      return both\n    }\n\n    const people = function (n) {\n      let res = ' '\n      res += n || 'no'\n      if (n === 1) return res + ' person'\n      return res + ' people'\n    }\n    const say = function (str) {\n      console.log(str)\n      const p = dom.createElement('p')\n      p.textContent = str\n      tips.appendChild(p)\n    }\n\n    const link = function (contents, uri) {\n      if (!uri) return contents\n      const a = dom.createElement('a')\n      a.setAttribute('href', uri)\n      a.appendChild(contents)\n      return a\n    }\n\n    const text = function (str) {\n      return dom.createTextNode(str)\n    }\n\n    const buildCheckboxForm = function (lab, statement, state) {\n      const f = dom.createElement('form')\n      const input = dom.createElement('input')\n      f.appendChild(input)\n      const tx = dom.createTextNode(lab)\n      tx.className = 'question'\n      f.appendChild(tx)\n      input.setAttribute('type', 'checkbox')\n      const boxHandler = function (_e) {\n        tx.className = 'pendingedit'\n        // alert('Should be greyed out')\n        if (this.checked) {\n          // Add link\n          try {\n            outliner.UserInput.sparqler.insert_statement(statement, function (\n              uri,\n              success,\n              errorBody\n            ) {\n              tx.className = 'question'\n              if (!success) {\n                UI.log.alert(\n                  null,\n                  'Message',\n                  'Error occurs while inserting ' +\n                    statement +\n                    '\\n\\n' +\n                    errorBody\n                )\n                input.checked = false // rollback UI\n                return\n              }\n              kb.add(\n                statement.subject,\n                statement.predicate,\n                statement.object,\n                statement.why\n              )\n            })\n          } catch (e) {\n            UI.log.error('Data write fails:' + e)\n            UI.log.alert('Data write fails:' + e)\n            input.checked = false // rollback UI\n            tx.className = 'question'\n          }\n        } else {\n          // Remove link\n          try {\n            outliner.UserInput.sparqler.delete_statement(statement, function (\n              uri,\n              success,\n              errorBody\n            ) {\n              tx.className = 'question'\n              if (!success) {\n                UI.log.alert(\n                  'Error occurs while deleting ' +\n                    statement +\n                    '\\n\\n' +\n                    errorBody\n                )\n                this.checked = true // Rollback UI\n              } else {\n                kb.removeMany(\n                  statement.subject,\n                  statement.predicate,\n                  statement.object,\n                  statement.why\n                )\n              }\n            })\n          } catch (e) {\n            UI.log.alert('Delete fails:' + e)\n            this.checked = true // Rollback UI\n            // return\n          }\n        }\n      }\n      input.checked = state\n      input.addEventListener('click', boxHandler, false)\n      return f\n    }\n\n    const oneFriend = function (friend, _confirmed) {\n      return UI.widgets.personTR(dom, UI.ns.foaf('knows'), friend, {})\n    }\n\n    // ////////// Body of render():\n\n    var outliner = context.getOutliner(dom)\n    var kb = context.session.store\n    const div = dom.createElement('div')\n    div.setAttribute('class', 'socialPane')\n    const foaf = UI.ns.foaf\n    const vcard = UI.ns.vcard\n\n    // extracted from tabbedtab.css 2017-03-21\n    const navBlockStyle =\n      'background-color: #eee; width: 25%; border: 0; padding: 0.5em; margin: 0;'\n    const mainBlockStyle =\n      'background-color: #fff; color: #000; width: 46%; margin: 0; border-left: 1px solid #ccc; border-right: 1px solid #ccc; border-bottom: 1px solid #ccc; padding: 0;'\n    const foafPicStyle = ' width: 100% ; border: none; margin: 0; padding: 0;'\n\n    const structure = div.appendChild(dom.createElement('table'))\n    const tr = structure.appendChild(dom.createElement('tr'))\n    const left = tr.appendChild(dom.createElement('td'))\n    const middle = tr.appendChild(dom.createElement('td'))\n    const right = tr.appendChild(dom.createElement('td'))\n\n    const tools = left\n    tools.style.cssText = navBlockStyle\n    const mainTable = middle.appendChild(dom.createElement('table'))\n    mainTable.style.cssText = mainBlockStyle\n    var tips = right\n    tips.style.cssText = navBlockStyle\n\n    // Image top left\n    const src = kb.any(s, foaf('img')) || kb.any(s, foaf('depiction'))\n    if (src) {\n      const img = dom.createElement('IMG')\n      img.setAttribute('src', src.uri) // w640 h480\n      // img.className = 'foafPic'\n      img.style.cssText = foafPicStyle\n      tools.appendChild(img)\n    }\n    const name = kb.anyValue(s, foaf('name')) || '???'\n    let h3 = dom.createElement('H3')\n    h3.appendChild(dom.createTextNode(name))\n\n    let me = UI.authn.currentUser()\n    const meUri = me ? me.uri : null\n\n    // @@ Add: event handler to redraw the stuff below when me changes.\n    const loginOutButton = UI.authn.loginStatusBox(dom, webIdUri => {\n      me = kb.sym(webIdUri)\n      // @@ To be written:   redraw as a function the new me\n      // @@ refresh the sidebars\n      UI.widgets.refreshTree(div) // this refreshes the middle at least\n    })\n\n    tips.appendChild(loginOutButton)\n\n    const thisIsYou = me && kb.sameThings(me, s)\n\n    const knows = foaf('knows')\n    //        var givenName = kb.sym('http://www.w3.org/2000/10/swap/pim/contact#givenName')\n    const familiar =\n      kb.anyValue(s, foaf('givenname')) ||\n      kb.anyValue(s, foaf('firstName')) ||\n      kb.anyValue(s, foaf('nick')) ||\n      kb.anyValue(s, foaf('name')) ||\n      kb.anyValue(s, vcard('fn'))\n    const friends = kb.each(s, knows)\n\n    // Do I have a public profile document?\n    let profile = null // This could be  SPARQL { ?me foaf:primaryTopic [ a foaf:PersonalProfileDocument ] }\n    let editable = false\n    if (me) {\n      // The definition of FAF personal profile document is ..\n      const works = kb.each(undefined, foaf('primaryTopic'), me) // having me as primary topic\n      let message = ''\n      for (let i = 0; i < works.length; i++) {\n        if (\n          kb.whether(\n            works[i],\n            UI.ns.rdf('type'),\n            foaf('PersonalProfileDocument')\n          )\n        ) {\n          editable = outliner.UserInput.sparqler.editable(works[i].uri, kb)\n          if (!editable) {\n            message +=\n              'Your profile <' +\n              UI.utils.escapeForXML(works[i].uri) +\n              '> is not remotely editable.'\n          } else {\n            profile = works[i]\n            break\n          }\n        }\n      }\n\n      if (!profile) {\n        say(\n          message + \"\\nI couldn't find your editable personal profile document.\"\n        )\n      } else {\n        say('Editing your profile ' + profile + '.')\n        // Do I have an EDITABLE profile?\n        editable = outliner.UserInput.sparqler.editable(profile.uri, kb)\n      }\n\n      if (thisIsYou) {\n        // This is about me\n        // pass... @@\n      } else {\n        // This is about someone else\n        // My relationship with this person\n\n        h3 = dom.createElement('h3')\n        h3.appendChild(dom.createTextNode('You and ' + familiar))\n        tools.appendChild(h3)\n\n        const cme = kb.canon(me)\n        var incoming = kb.whether(s, knows, cme)\n        var outgoing = false\n        const outgoingSt = kb.statementsMatching(cme, knows, s)\n        if (outgoingSt.length) {\n          outgoing = true\n          if (!profile) profile = outgoingSt[0].why\n        }\n\n        const tr = dom.createElement('tr')\n        tools.appendChild(tr)\n\n        const youAndThem = function () {\n          tr.appendChild(link(text('You'), meUri))\n          tr.appendChild(text(' and '))\n          tr.appendChild(link(text(familiar), s.uri))\n        }\n\n        if (!incoming) {\n          if (!outgoing) {\n            youAndThem()\n            tr.appendChild(text(' have not said you know each other.'))\n          } else {\n            tr.appendChild(link(text('You'), meUri))\n            tr.appendChild(text(' know '))\n            tr.appendChild(link(text(familiar), s.uri))\n            tr.appendChild(text(' (unconfirmed)'))\n          }\n        } else {\n          if (!outgoing) {\n            tr.appendChild(link(text(familiar), s.uri))\n            tr.appendChild(text(' knows '))\n            tr.appendChild(link(text('you'), meUri))\n            tr.appendChild(text(' (unconfirmed).')) // @@\n            tr.appendChild(text(' confirm you know '))\n            tr.appendChild(link(text(familiar), s.uri))\n            tr.appendChild(text('.'))\n          } else {\n            youAndThem()\n            tr.appendChild(text(' say you know each other.'))\n          }\n        }\n\n        if (editable) {\n          const f = buildCheckboxForm(\n            'You know ' + familiar,\n            new UI.rdf.Statement(me, knows, s, profile),\n            outgoing\n          )\n          tools.appendChild(f)\n        } // editable\n\n        // //////////////// Mutual friends\n        if (friends) {\n          const myFriends = kb.each(me, foaf('knows'))\n          if (myFriends.length) {\n            const mutualFriends = common(friends, myFriends)\n            const tr = dom.createElement('tr')\n            tools.appendChild(tr)\n            tr.appendChild(\n              dom.createTextNode(\n                'You' +\n                  (familiar ? ' and ' + familiar : '') +\n                  ' know' +\n                  people(mutualFriends.length) +\n                  ' found in common'\n              )\n            )\n            if (mutualFriends) {\n              for (let i = 0; i < mutualFriends.length; i++) {\n                tr.appendChild(\n                  dom.createTextNode(',  ' + UI.utils.label(mutualFriends[i]))\n                )\n              }\n            }\n          }\n          const tr = dom.createElement('tr')\n          tools.appendChild(tr)\n        } // friends\n      } // About someone else\n    } // me is defined\n    // End of you and s\n\n    // div.appendChild(dom.createTextNode(plural(friends.length, 'acquaintance') +'. '))\n\n    // /////////////////////////////////////////////  Main block\n    //\n    // Should: Find the intersection and difference sets\n\n    // List all x such that s knows x.\n    UI.widgets.attachmentList(dom, s, mainTable, {\n      doc: profile,\n      modify: !!editable,\n      predicate: foaf('knows'),\n      noun: 'friend'\n    })\n\n    // Figure out which are reciprocated:\n    // @@ Does not look up profiles\n    // Does distinguish reciprocated from unreciprocated friendships\n    //\n    function triageFriends (s) {\n      outgoing = kb.each(s, foaf('knows'))\n      incoming = kb.each(undefined, foaf('knows'), s) // @@ have to load the friends\n      const confirmed = []\n      const unconfirmed = []\n      const requests = []\n\n      for (let i = 0; i < outgoing.length; i++) {\n        const friend = outgoing[i]\n        let found = false\n        for (let j = 0; j < incoming.length; j++) {\n          if (incoming[j].sameTerm(friend)) {\n            found = true\n            break\n          }\n        }\n        if (found) confirmed.push(friend)\n        else unconfirmed.push(friend)\n      } // outgoing\n\n      for (let i = 0; i < incoming.length; i++) {\n        const friend = incoming[i]\n        // var lab = UI.utils.label(friend)\n        let found = false\n        for (let j = 0; j < outgoing.length; j++) {\n          if (outgoing[j].sameTerm(friend)) {\n            found = true\n            break\n          }\n        }\n        if (!found) requests.push(friend)\n      } // incoming\n\n      const cases = [\n        ['Acquaintances', outgoing],\n        ['Mentioned as acquaintances by: ', requests]\n      ]\n      for (let i = 0; i < cases.length; i++) {\n        const thisCase = cases[i]\n        const friends = thisCase[1]\n        if (friends.length === 0) continue // Skip empty sections (sure?)\n\n        const h3 = dom.createElement('h3')\n        h3.textContent = thisCase[0]\n        const htr = dom.createElement('tr')\n        htr.appendChild(h3)\n        mainTable.appendChild(htr)\n\n        const items = []\n        for (let j9 = 0; j9 < friends.length; j9++) {\n          items.push([UI.utils.label(friends[j9]), friends[j9]])\n        }\n        items.sort()\n        let last = null\n        var fr\n        for (let j7 = 0; j7 < items.length; j7++) {\n          fr = items[j7][1]\n          if (fr.sameTerm(last)) continue // unique\n          last = fr\n          if (UI.utils.label(fr) !== '...') {\n            // This check is to avoid bnodes with no labels attached\n            // appearing in the friends list with \"...\" - Oshani\n            mainTable.appendChild(oneFriend(fr))\n          }\n        }\n      }\n    }\n    if ($rdf.keepThisCodeForLaterButDisableFerossConstantConditionPolice) {\n      triageFriends(s)\n    }\n    // //////////////////////////////////// Basic info on left\n\n    h3 = dom.createElement('h3')\n    h3.appendChild(dom.createTextNode('Basic Information'))\n    tools.appendChild(h3)\n\n    // For each home page like thing make a label which will\n    // make sense and add the domain (like \"w3.org blog\") if there are more than one of the same type\n    //\n    const preds = [\n      UI.ns.foaf('homepage'),\n      UI.ns.foaf('weblog'),\n      UI.ns.foaf('workplaceHomepage'),\n      UI.ns.foaf('schoolHomepage')\n    ]\n    for (let i6 = 0; i6 < preds.length; i6++) {\n      const pred = preds[i6]\n      const sts = kb.statementsMatching(s, pred)\n      if (sts.length === 0) {\n        // if (editable) say(\"No home page set. Use the blue + icon at the bottom of the main view to add information.\")\n      } else {\n        const uris = []\n        for (let j5 = 0; j5 < sts.length; j5++) {\n          const st = sts[j5]\n          if (st.object.uri) uris.push(st.object.uri) // Ignore if not symbol\n        }\n        uris.sort()\n        let last2 = ''\n        var lab2\n        for (let k = 0; k < uris.length; k++) {\n          const uri = uris[k]\n          if (uri === last2) continue // uniques only\n          last2 = uri\n          let hostlabel = ''\n          lab2 = UI.utils.label(pred)\n          if (uris.length > 1) {\n            const l = uri.indexOf('//')\n            if (l > 0) {\n              let r = uri.indexOf('/', l + 2)\n              const r2 = uri.lastIndexOf('.', r)\n              if (r2 > 0) r = r2\n              hostlabel = uri.slice(l + 2, r)\n            }\n          }\n          if (hostlabel) lab2 = hostlabel + ' ' + lab2 // disambiguate\n          const t = dom.createTextNode(lab2)\n          const a = dom.createElement('a')\n          a.appendChild(t)\n          a.setAttribute('href', uri)\n          const d = dom.createElement('div')\n          // d.className = 'social_linkButton'\n          d.style.cssText =\n            'width: 80%; background-color: #fff; border: solid 0.05em #ccc;  margin-top: 0.1em; margin-bottom: 0.1em; padding: 0.1em; text-align: center;'\n          d.appendChild(a)\n          tools.appendChild(d)\n        }\n      }\n    }\n\n    const preds2 = [UI.ns.foaf('openid'), UI.ns.foaf('nick')]\n    for (let i2 = 0; i2 < preds2.length; i2++) {\n      const pred = preds2[i2]\n      const sts2 = kb.statementsMatching(s, pred)\n      if (sts2.length === 0) {\n        // if (editable) say(\"No home page set. Use the blue + icon at the bottom of the main view to add information.\")\n      } else {\n        outliner.appendPropertyTRs(tools, sts2, false, function (_pred) {\n          return true\n        })\n      }\n    }\n\n    return div\n  } // render()\n} //\n// ends\n"],"file":"socialPane.js"}