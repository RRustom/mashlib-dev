{"version":3,"sources":["../../src/transaction/pane.js"],"names":["UI","require","$rdf","ns","module","exports","icon","icons","iconBase","name","audience","solid","label","subject","context","kb","session","store","t","findTypeURIs","any","qu","render","dom","fetcher","Q","Namespace","TRIP","div","createElement","setAttribute","mention","message","style","undefined","pre","appendChild","createTextNode","complain","plist","statementsMatching","qlist","predicateURIsDone","donePredicate","pred","uri","setPaneStyle","account","mystyle","backgroundColor","ui","value","d2","n","s","indexOf","split","slice","numericCell","amount","suppressZero","td","textContent","headerCell","str","oderByDate","x","y","dx","dy","insertedPane","paneName","p","paneRegistry","byName","d","expandAfterRow","row","solo","siblings","parentNode","children","j","length","expanded","removeChild","tr","cols","nextSibling","insertBefore","expandAfterRowOrCollapse","transactionTable","list","filter","table","transactionRow","setTRStyle","c0","date","c1","payee","a1","c3","addEventListener","e","shiftKey","list2","sort","i","rdf","statement","nav","navLink","obj","a","utils","preds","map","inner","labelForXML","join","innerHTML","complainIfBad","ok","body","nowOrWhenFetched","calendarYear","renderCatgorySelectors","widgets","makeSelectForNestedCategory","rdfs","Classified","load","then","_xhrs","each","console","log","makeDescription","trips","st","object","trips2","concat","sortedBy","reverse","l2","key","pair","cal","makeSelectForOptions","multiple","nullLabel","mint","mintClass","mintStatementsFun","trip","is","push","doc","outliner","getOutliner","attachmentList","wf","appendPropertyTRs","_inverse","calculations","total","yearTotal","yearCategoryTotal","trans","bankStatements","forEach","the","year","ty","tyuri","lit","parseFloat","types","grandTotal","years","hasOwnProperty","ny","cell","header","z","cat","sym","tab"],"mappings":"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","sourcesContent":["/*   Financial Transaction Pane\n **\n **  This outline pane allows a user to interact with a transaction\n **  downloaded from a bank statement, annotting it with classes and comments,\n ** trips, etc\n */\n\nconst UI = require('solid-ui')\nconst $rdf = require('rdflib')\nconst ns = UI.ns\n\nmodule.exports = {\n  // icon:  (module.__dirname || __dirname) + '22-pixel-068010-3d-transparent-glass-icon-alphanumeric-dollar-sign.png',\n  icon: UI.icons.iconBase + 'noun_106746.svg',\n\n  name: 'transaction',\n\n  audience: [ns.solid('PowerUser')],\n\n  // Does the subject deserve this pane?\n  label: function (subject, context) {\n    const kb = context.session.store\n    const t = kb.findTypeURIs(subject)\n    if (t['http://www.w3.org/2000/10/swap/pim/qif#Transaction']) return '$$'\n    if (kb.any(subject, UI.ns.qu('amount'))) return '$$$' // In case schema not picked up\n\n    // if (t['http://www.w3.org/2000/10/swap/pim/qif#Period']) return \"period $\"\n\n    if (t['http://www.w3.org/ns/pim/trip#Trip']) return 'Trip $'\n\n    return null // No under other circumstances (while testing at least!)\n  },\n\n  render: function (subject, context) {\n    const dom = context.dom\n    const kb = context.session.store\n    const fetcher = kb.fetcher\n    const Q = $rdf.Namespace('http://www.w3.org/2000/10/swap/pim/qif#')\n    const TRIP = $rdf.Namespace('http://www.w3.org/ns/pim/trip#')\n\n    const div = dom.createElement('div')\n    div.setAttribute('class', 'transactionPane')\n\n    const mention = function mention (message, style) {\n      if (style === undefined) style = 'color: grey'\n      const pre = dom.createElement('pre')\n      pre.setAttribute('style', style)\n      div.appendChild(pre)\n      pre.appendChild(dom.createTextNode(message))\n    }\n    const complain = function complain (message) {\n      return mention(message, 'color: #100; background-color: #fee')\n    }\n\n    /*\n    var thisPane = this\n    var rerender = function (div) {\n      var parent = div.parentNode\n      var div2 = thisPane.render(subject, dom)\n      parent.replaceChild(div2, div)\n    }\n    */\n    // //////////////////////////////////////////////////////////////////////////////\n\n    const plist = kb.statementsMatching(subject)\n    const qlist = kb.statementsMatching(undefined, undefined, subject)\n\n    const t = kb.findTypeURIs(subject)\n\n    // var me = UI.authn.currentUser()\n    const predicateURIsDone = {}\n    const donePredicate = function (pred) {\n      predicateURIsDone[pred.uri] = true\n    }\n\n    const setPaneStyle = function (account) {\n      let mystyle = 'padding: 0.5em 1.5em 1em 1.5em; '\n      if (account) {\n        const backgroundColor = kb.any(account, UI.ns.ui('backgroundColor'))\n        if (backgroundColor) {\n          mystyle += 'background-color: ' + backgroundColor.value + '; '\n        }\n      }\n      div.setAttribute('style', mystyle)\n    }\n    // setPaneStyle()\n\n    // Functions for displaying lists of transactions\n    // Click on the transaction line to expand it into a pane\n    // Shift-click to expand without collapsing others\n\n    const d2 = function (n) {\n      if (n === undefined) return ''\n      const s = '' + n\n      if (s.indexOf('.') >= 0) {\n        return s.split('.')[0] + '.' + (s.split('.')[1] + '00').slice(0, 2)\n      }\n      return s + '.00'\n    }\n\n    const numericCell = function numericCell (amount, suppressZero) {\n      const td = dom.createElement('td')\n      if (!(0.0 + amount === 0.0 && suppressZero)) {\n        td.textContent = d2(amount)\n      }\n      td.setAttribute('style', 'width: 6em; text-align: right; ')\n      return td\n    }\n\n    const headerCell = function headerCell (str) {\n      const td = dom.createElement('th')\n      td.textContent = str\n      td.setAttribute('style', 'text-align: right; ')\n      return td\n    }\n\n    const oderByDate = function (x, y) {\n      const dx = kb.any(x, ns.qu('date'))\n      const dy = kb.any(y, ns.qu('date'))\n      if (dx !== undefined && dy !== undefined) {\n        if (dx.value < dy.value) return -1\n        if (dx.value > dy.value) return 1\n      }\n      if (x.uri < y.uri) return -1 // Arbitrary but repeatable\n      if (x.uri > y.uri) return 1\n      return 0\n    }\n\n    const insertedPane = function (context, subject, paneName) {\n      const p = context.session.paneRegistry.byName(paneName)\n      const d = p.render(subject, context)\n      d.setAttribute('style', 'border: 0.1em solid green;')\n      return d\n    }\n\n    const expandAfterRow = function (dom, row, subject, paneName, solo) {\n      const siblings = row.parentNode.children\n      if (solo) {\n        for (let j = siblings.length - 1; j >= 0; j--) {\n          if (siblings[j].expanded) {\n            siblings[j].parentNode.removeChild(siblings[j].expanded)\n            siblings[j].expanded = false\n          }\n        }\n      }\n      const tr = dom.createElement('tr')\n      const td = tr.appendChild(dom.createElement('td'))\n      td.setAttribute(\n        'style',\n        'width: 98%; padding: 1em; border: 0.1em solid grey;'\n      )\n      const cols = row.children.length\n      if (row.nextSibling) {\n        row.parentNode.insertBefore(tr, row.nextSibling)\n      } else {\n        row.parentNode.appendChild(tr)\n      }\n      row.expanded = tr\n      td.setAttribute('colspan', '' + cols)\n      td.appendChild(insertedPane(context, subject, paneName))\n    }\n\n    const expandAfterRowOrCollapse = function (\n      dom,\n      row,\n      subject,\n      paneName,\n      solo\n    ) {\n      if (row.expanded) {\n        row.parentNode.removeChild(row.expanded)\n        row.expanded = false\n      } else {\n        expandAfterRow(dom, row, subject, paneName, solo)\n      }\n    }\n\n    const transactionTable = function (dom, list, filter) {\n      const table = dom.createElement('table')\n      table.setAttribute(\n        'style',\n        'padding-left: 0.5em; padding-right: 0.5em; font-size: 9pt; width: 85%;'\n      )\n      const transactionRow = function (dom, x) {\n        const tr = dom.createElement('tr')\n\n        const setTRStyle = function (tr, account) {\n          // var mystyle = \"padding: 0.5em 1.5em 1em 1.5em; \"\n          let mystyle =\n            \"'padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.1em;\"\n          if (account) {\n            const backgroundColor = kb.any(account, UI.ns.ui('backgroundColor'))\n            if (backgroundColor) {\n              mystyle += 'background-color: ' + backgroundColor.value + '; '\n            }\n          }\n          tr.setAttribute('style', mystyle)\n        }\n\n        const account = kb.any(x, ns.qu('toAccount'))\n        setTRStyle(tr, account)\n\n        const c0 = tr.appendChild(dom.createElement('td'))\n        const date = kb.any(x, ns.qu('date'))\n        c0.textContent = date ? date.value.slice(0, 10) : '???'\n        c0.setAttribute('style', 'width: 7em;')\n\n        const c1 = tr.appendChild(dom.createElement('td'))\n        c1.setAttribute('style', 'width: 36em;')\n        const payee = kb.any(x, ns.qu('payee'))\n        c1.textContent = payee ? payee.value : '???'\n        const a1 = c1.appendChild(dom.createElement('a'))\n        a1.textContent = ' ➜'\n        a1.setAttribute('href', x.uri)\n\n        const c3 = tr.appendChild(dom.createElement('td'))\n        const amount = kb.any(x, ns.qu('in_USD'))\n        c3.textContent = amount ? d2(amount.value) : '???'\n        c3.setAttribute('style', 'width: 6em; text-align: right; ') // @@ decimal alignment?\n        tr.addEventListener(\n          'click',\n          function (e) {\n            // solo unless shift key\n            expandAfterRowOrCollapse(dom, tr, x, 'transaction', !e.shiftKey)\n          },\n          false\n        )\n\n        return tr\n      }\n\n      const list2 = filter ? list.filter(filter) : list.slice() // don't sort a paramater passed in place\n      list2.sort(oderByDate)\n\n      for (let i = 0; i < list2.length; i++) {\n        table.appendChild(transactionRow(dom, list2[i]))\n      }\n      return table\n    }\n\n    //              Render a single transaction\n\n    // This works only if enough metadata about the properties can drive the RDFS\n    // (or actual type statements whichtypically are NOT there on)\n    if (\n      t['http://www.w3.org/2000/10/swap/pim/qif#Transaction'] ||\n      kb.any(subject, ns.qu('toAccount'))\n    ) {\n      // var trip = kb.any(subject, WF('trip'))\n      donePredicate(ns.rdf('type'))\n\n      const account = kb.any(subject, UI.ns.qu('toAccount'))\n      setPaneStyle(account)\n      if (!account) {\n        complain(\n          '(Error: There is no bank account known for this transaction <' +\n            subject.uri +\n            '>,\\n -- every transaction needs one.)'\n        )\n      }\n\n      let store = null\n      const statement = kb.any(subject, UI.ns.qu('accordingTo'))\n      if (statement === undefined) {\n        complain(\n          '(Error: There is no back link to the original data source foir this transaction <' +\n            subject.uri +\n            \">,\\nso I can't tell how to annotate it.)\"\n        )\n      } else {\n        store =\n          statement !== undefined\n            ? kb.any(statement, UI.ns.qu('annotationStore'))\n            : null\n        if (store === undefined) {\n          complain(\n            '(There is no annotation document for this statement\\n<' +\n              statement.uri +\n              '>,\\nso you cannot classify this transaction.)'\n          )\n        }\n      }\n\n      const nav = dom.createElement('div')\n      nav.setAttribute('style', 'float:right')\n      div.appendChild(nav)\n\n      const navLink = function (pred, label) {\n        donePredicate(pred)\n        const obj = kb.any(subject, pred)\n        if (!obj) return\n        const a = dom.createElement('a')\n        a.setAttribute('href', obj.uri)\n        a.setAttribute('style', 'float:right')\n        nav.appendChild(a).textContent = label || UI.utils.label(obj)\n        nav.appendChild(dom.createElement('br'))\n      }\n\n      navLink(UI.ns.qu('toAccount'))\n      navLink(UI.ns.qu('accordingTo'), 'Statement')\n      navLink(TRIP('trip'))\n\n      // Basic data:\n      const table = dom.createElement('table')\n      div.appendChild(table)\n      const preds = ['date', 'payee', 'amount', 'in_USD', 'currency'].map(Q)\n      const inner = preds\n        .map(function (p) {\n          donePredicate(p)\n          const value = kb.any(subject, p)\n          const s = value ? UI.utils.labelForXML(value) : ''\n          return (\n            '<tr><td style=\"text-align: right; padding-right: 0.6em\">' +\n            UI.utils.labelForXML(p) +\n            '</td><td style=\"font-weight: bold;\">' +\n            s +\n            '</td></tr>'\n          )\n        })\n        .join('\\n')\n      table.innerHTML = inner\n\n      const complainIfBad = function (ok, body) {\n        if (ok) {\n          // setModifiedDate(store, kb, store)\n          // rerender(div) // deletes the new trip form\n        } else complain('Sorry, failed to save your change:\\n' + body)\n      }\n\n      // What trips do we know about?\n\n      // Classify:\n      if (store) {\n        kb.fetcher.nowOrWhenFetched(store.uri, subject, function (ok, body) {\n          if (!ok) complain('Cannot load store ' + store + ' ' + body)\n\n          const calendarYear = kb.any(store, ns.qu('calendarYear'))\n\n          const renderCatgorySelectors = function () {\n            div.insertBefore(\n              UI.widgets.makeSelectForNestedCategory(\n                dom,\n                kb,\n                subject,\n                UI.ns.qu('Classified'),\n                store,\n                complainIfBad\n              ),\n              table.nextSibling\n            )\n          }\n\n          if (kb.any(undefined, ns.rdfs('subClassOf'), ns.qu.Classified)) {\n            renderCatgorySelectors()\n          } else if (calendarYear) {\n            fetcher\n              .load(calendarYear)\n              .then(function (_xhrs) {\n                fetcher\n                  .load(kb.each(calendarYear, ns.rdfs('seeAlso')))\n                  .then(function () {\n                    renderCatgorySelectors()\n                  })\n                  .catch(function (e) {\n                    console.log('Error loading background data: ' + e)\n                  })\n              })\n              .catch(function (e) {\n                console.log('Error loading calendarYear: ' + e)\n              })\n          } else {\n            console.log(\"Can't get categories, because no calendarYear\")\n          }\n          div.appendChild(\n            UI.widgets.makeDescription(\n              dom,\n              kb,\n              subject,\n              UI.ns.rdfs('comment'),\n              store,\n              complainIfBad\n            )\n          )\n\n          let trips = kb\n            .statementsMatching(undefined, TRIP('trip'), undefined, store)\n            .map(function (st) {\n              return st.object\n            }) // @@ Use rdfs\n          const trips2 = kb.each(undefined, UI.ns.rdf('type'), TRIP('Trip'))\n          trips = trips.concat(trips2).sort() // @@ Unique\n\n          const sortedBy = function (kb, list, pred, reverse) {\n            const l2 = list.map(function (x) {\n              let key = kb.any(x, pred)\n              key = key ? key.value : '9999-12-31'\n              return [key, x]\n            })\n            l2.sort()\n            if (reverse) l2.reverse()\n            return l2.map(function (pair) {\n              return pair[1]\n            })\n          }\n\n          trips = sortedBy(kb, trips, UI.ns.cal('dtstart'), true) // Reverse chron\n\n          if (trips.length > 1) {\n            div.appendChild(\n              UI.widgets.makeSelectForOptions(\n                dom,\n                kb,\n                subject,\n                TRIP('trip'),\n                trips,\n                {\n                  multiple: false,\n                  nullLabel: '-- what trip? --',\n                  mint: 'New Trip *',\n                  mintClass: TRIP('Trip'),\n                  mintStatementsFun: function (trip) {\n                    const is = []\n                    is.push(\n                      $rdf.st(trip, UI.ns.rdf('type'), TRIP('Trip'), trip.doc())\n                    )\n                    return is\n                  }\n                },\n                store,\n                complainIfBad\n              )\n            )\n          }\n\n          div.appendChild(dom.createElement('br'))\n\n          // Add in simple comments about the transaction\n\n          const outliner = context.getOutliner(dom)\n\n          donePredicate(ns.rdfs('comment')) // Done above\n\n          UI.widgets.attachmentList(dom, subject, div)\n          donePredicate(ns.wf('attachment'))\n\n          div\n            .appendChild(dom.createElement('tr'))\n            .setAttribute('style', 'height: 1em') // spacer\n\n          // Remaining properties\n          outliner.appendPropertyTRs(div, plist, false, function (\n            pred,\n            _inverse\n          ) {\n            return !(pred.uri in predicateURIsDone)\n          })\n          outliner.appendPropertyTRs(div, qlist, true, function (\n            pred,\n            _inverse\n          ) {\n            return !(pred.uri in predicateURIsDone)\n          })\n        }) // fetch\n      }\n      // end of render tranasaction instance\n\n      // ////////////////////////////////////////////////////////////////////\n      //\n      //      Render the transactions in a Trip\n      //\n    } else if (t['http://www.w3.org/ns/pim/trip#Trip']) {\n      /*\n          var query = new $rdf.Query(UI.utils.label(subject))\n          var vars =  [ 'date', 'transaction', 'comment', 'type',  'in_USD']\n          var v = {}\n          vars.map(function(x){query.vars.push(v[x]=$rdf.variable(x))}) // Only used by UI\n          query.pat.add(v['transaction'], TRIP('trip'), subject)\n\n          var opt = kb.formula()\n          opt.add(v['transaction'], ns.rdf('type'), v['type']); // Issue: this will get stored supertypes too\n          query.pat.optional.push(opt)\n\n          query.pat.add(v['transaction'], UI.ns.qu('date'), v['date'])\n\n          var opt = kb.formula()\n          opt.add(v['transaction'], ns.rdfs('comment'), v['comment'])\n          query.pat.optional.push(opt)\n\n          //opt = kb.formula()\n          query.pat.add(v['transaction'], UI.ns.qu('in_USD'), v['in_USD'])\n\n          //query.pat.optional.push(opt)\n\n          var tableDiv = UI.widgets.renderTableViewPane(dom, {'query': query, 'onDone': calculations} )\n          div.appendChild(tableDiv)\n\n*/\n      const calculations = function () {\n        const total = {}\n        const yearTotal = {}\n        const yearCategoryTotal = {}\n        const trans = kb.each(undefined, TRIP('trip'), subject)\n        const bankStatements = trans.map(function (t) {\n          return t.doc()\n        })\n        kb.fetcher\n          .load(bankStatements)\n          .then(function () {\n            trans.forEach(function (t) {\n              const date = kb.the(t, ns.qu('date'))\n              const year = date ? ('' + date.value).slice(0, 4) : '????'\n              let ty = kb.the(t, ns.rdf('type')) // @@ find most specific type\n              // complain(\" -- one trans: \"+t.uri + ' -> '+kb.any(t, UI.ns.qu('in_USD')))\n              if (!ty) ty = UI.ns.qu('ErrorNoType')\n              if (ty && ty.uri) {\n                const tyuri = ty.uri\n                if (!yearTotal[year]) yearTotal[year] = 0.0\n                if (!yearCategoryTotal[year]) yearCategoryTotal[year] = {}\n                if (!total[tyuri]) total[tyuri] = 0.0\n                if (!yearCategoryTotal[year][tyuri]) {\n                  yearCategoryTotal[year][tyuri] = 0.0\n                }\n\n                const lit = kb.any(t, UI.ns.qu('in_USD'))\n                if (!lit) {\n                  complain('@@ No amount in USD: ' + lit + ' for ' + t)\n                }\n                if (lit) {\n                  const amount = parseFloat(lit.value)\n                  total[tyuri] += amount\n                  yearCategoryTotal[year][tyuri] += amount\n                  yearTotal[year] += amount\n                }\n              }\n            })\n\n            const types = []\n            let grandTotal = 0.0\n            const years = []\n            let i\n\n            for (const y in yearCategoryTotal) {\n              // @@ TODO: Write away the need for exception on next line\n              // eslint-disable-next-line no-prototype-builtins\n              if (yearCategoryTotal.hasOwnProperty(y)) {\n                years.push(y)\n              }\n            }\n            years.sort()\n            const ny = years.length\n            let cell\n\n            const table = div.appendChild(dom.createElement('table'))\n            table.setAttribute(\n              'style',\n              'font-size: 120%; margin-left:auto; margin-right:1em; margin-top: 1em; border: 0.05em solid gray; padding: 1em;'\n            )\n\n            if (ny > 1) {\n              const header = table.appendChild(dom.createElement('tr'))\n              header.appendChild(headerCell(''))\n              for (i = 0; i < ny; i++) {\n                header.appendChild(headerCell(years[i]))\n              }\n              header.appendChild(headerCell('total'))\n            }\n\n            for (const uri in total) {\n              // @@ TODO: Write away the need for exception on next line\n              // eslint-disable-next-line no-prototype-builtins\n              if (total.hasOwnProperty(uri)) {\n                types.push(uri)\n                grandTotal += total[uri]\n              }\n            }\n            types.sort()\n            let row, label, z\n            for (let j = 0; j < types.length; j++) {\n              const cat = kb.sym(types[j])\n              row = table.appendChild(dom.createElement('tr'))\n              label = row.appendChild(dom.createElement('td'))\n              label.textContent = UI.utils.label(cat)\n              if (ny > 1) {\n                for (i = 0; i < ny; i++) {\n                  z = yearCategoryTotal[years[i]][types[j]]\n                  cell = row.appendChild(numericCell(z, true))\n                }\n              }\n              row.appendChild(numericCell(total[types[j]], true))\n            }\n\n            // Trailing totals\n            if (types.length > 1) {\n              row = table.appendChild(dom.createElement('tr'))\n              row.appendChild(headerCell('total'))\n              if (ny > 1) {\n                for (i = 0; i < ny; i++) {\n                  z = yearTotal[years[i]]\n                  cell = row.appendChild(numericCell(z ? d2(z) : ''))\n                }\n              }\n              cell = row.appendChild(numericCell(grandTotal))\n              cell.setAttribute(\n                'style',\n                'font-weight: bold; text-align: right;'\n              )\n            }\n\n            const tab = transactionTable(dom, trans)\n            tab.setAttribute(\n              'style',\n              'margin-left:auto; margin-right:1em; margin-top: 1em; border: padding: 1em;'\n            )\n            div.appendChild(tab)\n\n            UI.widgets.attachmentList(dom, subject, div)\n          })\n          .catch(function (e) {\n            complain('Error loading transactions: ' + e)\n          })\n      }\n      calculations()\n    } // if\n\n    return div\n  }\n}\n\n// ends\n"],"file":"pane.js"}