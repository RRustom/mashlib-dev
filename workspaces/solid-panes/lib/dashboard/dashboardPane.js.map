{"version":3,"sources":["../../src/dashboard/dashboardPane.ts"],"names":["dashboardPane","icon","icons","iconBase","name","label","subject","uri","site","render","context","dom","container","createElement","authn","solidAuthClient","trackSession","session","innerHTML","buildPage","webId","buildDashboard","buildHomePage","outliner","getOutliner","getDashboard","then","dashboard","appendChild","wrapper","document","shadow","attachShadow","mode","link","rel","href","store","fetcher","homepage"],"mappings":";;;;;;;AACA;;AACA;;AACA;;;;;;AAGO,IAAMA,aAA6B,GAAG;AAC3CC,EAAAA,IAAI,EAAEC,eAAMC,QAAN,GAAiB,iBADoB;AAE3CC,EAAAA,IAAI,EAAE,WAFqC;AAG3CC,EAAAA,KAAK,EAAE,eAAAC,OAAO,EAAI;AAChB,QAAIA,OAAO,CAACC,GAAR,KAAgBD,OAAO,CAACE,IAAR,GAAeD,GAAnC,EAAwC;AACtC,aAAO,WAAP;AACD;;AACD,WAAO,IAAP;AACD,GAR0C;AAS3CE,EAAAA,MAAM,EAAE,gBAACH,OAAD,EAAUI,OAAV,EAAsB;AAC5B,QAAMC,GAAG,GAAGD,OAAO,CAACC,GAApB;AACA,QAAMC,SAAS,GAAGD,GAAG,CAACE,aAAJ,CAAkB,KAAlB,CAAlB;;AACAC,mBAAMC,eAAN,CAAsBC,YAAtB;AAAA,yEAAmC,iBAAOC,OAAP;AAAA;AAAA;AAAA;AAAA;AACjCL,gBAAAA,SAAS,CAACM,SAAV,GAAsB,EAAtB;AACAC,gBAAAA,SAAS,CACPP,SADO,EAEPK,OAAO,GAAG,iBAAIA,OAAO,CAACG,KAAZ,CAAH,GAAwB,IAFxB,EAGPV,OAHO,EAIPJ,OAJO,CAAT;;AAFiC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAnC;;AAAA;AAAA;AAAA;AAAA;;AAUA,WAAOM,SAAP;AACD;AAvB0C,CAAtC;;;AA0BP,SAASO,SAAT,CACEP,SADF,EAEEQ,KAFF,EAGEV,OAHF,EAIEJ,OAJF,EAKE;AACA,MAAIc,KAAK,IAAIA,KAAK,CAACZ,IAAN,GAAaD,GAAb,KAAqBD,OAAO,CAACE,IAAR,GAAeD,GAAjD,EAAsD;AACpD,WAAOc,cAAc,CAACT,SAAD,EAAYF,OAAZ,CAArB;AACD;;AACD,SAAOY,aAAa,CAACV,SAAD,EAAYN,OAAZ,CAApB;AACD;;AAED,SAASe,cAAT,CAAyBT,SAAzB,EAAiDF,OAAjD,EAA8E;AAC5E;AACA,MAAMa,QAAa,GAAGb,OAAO,CAACc,WAAR,CAAoBd,OAAO,CAACC,GAA5B,CAAtB;AACAY,EAAAA,QAAQ,CACLE,YADH,GAEGC,IAFH,CAEQ,UAACC,SAAD;AAAA,WAA4Bf,SAAS,CAACgB,WAAV,CAAsBD,SAAtB,CAA5B;AAAA,GAFR;AAGD;;AAED,SAASL,aAAT,CAAwBV,SAAxB,EAAgDN,OAAhD,EAAoE;AAClE,MAAMuB,OAAO,GAAGC,QAAQ,CAACjB,aAAT,CAAuB,KAAvB,CAAhB;AACAD,EAAAA,SAAS,CAACgB,WAAV,CAAsBC,OAAtB;AACA,MAAME,MAAM,GAAGF,OAAO,CAACG,YAAR,CAAqB;AAAEC,IAAAA,IAAI,EAAE;AAAR,GAArB,CAAf;AACA,MAAMC,IAAI,GAAGJ,QAAQ,CAACjB,aAAT,CAAuB,MAAvB,CAAb;AACAqB,EAAAA,IAAI,CAACC,GAAL,GAAW,YAAX;AACAD,EAAAA,IAAI,CAACE,IAAL,GAAY,+BAAZ;AACAL,EAAAA,MAAM,CAACH,WAAP,CAAmBM,IAAnB;AACA,kCAAiB5B,OAAjB,EAA0B+B,cAA1B,EAAiCA,eAAMC,OAAvC,EAA2DZ,IAA3D,CAAgE,UAAAa,QAAQ;AAAA,WACtER,MAAM,CAACH,WAAP,CAAmBW,QAAnB,CADsE;AAAA,GAAxE;AAGD;;eAEcvC,a","sourcesContent":["import { SolidSession } from '../types'\nimport { authn, icons, store } from 'solid-ui'\nimport { Fetcher, NamedNode, sym } from 'rdflib'\nimport { generateHomepage } from './homepage'\nimport { DataBrowserContext, PaneDefinition } from 'pane-registry'\n\nexport const dashboardPane: PaneDefinition = {\n  icon: icons.iconBase + 'noun_547570.svg',\n  name: 'dashboard',\n  label: subject => {\n    if (subject.uri === subject.site().uri) {\n      return 'Dashboard'\n    }\n    return null\n  },\n  render: (subject, context) => {\n    const dom = context.dom\n    const container = dom.createElement('div')\n    authn.solidAuthClient.trackSession(async (session: SolidSession) => {\n      container.innerHTML = ''\n      buildPage(\n        container,\n        session ? sym(session.webId) : null,\n        context,\n        subject\n      )\n    })\n\n    return container\n  }\n}\n\nfunction buildPage (\n  container: HTMLElement,\n  webId: NamedNode | null,\n  context: DataBrowserContext,\n  subject: NamedNode\n) {\n  if (webId && webId.site().uri === subject.site().uri) {\n    return buildDashboard(container, context)\n  }\n  return buildHomePage(container, subject)\n}\n\nfunction buildDashboard (container: HTMLElement, context: DataBrowserContext) {\n  // @@ TODO get a proper type\n  const outliner: any = context.getOutliner(context.dom)\n  outliner\n    .getDashboard()\n    .then((dashboard: HTMLElement) => container.appendChild(dashboard))\n}\n\nfunction buildHomePage (container: HTMLElement, subject: NamedNode) {\n  const wrapper = document.createElement('div')\n  container.appendChild(wrapper)\n  const shadow = wrapper.attachShadow({ mode: 'open' })\n  const link = document.createElement('link')\n  link.rel = 'stylesheet'\n  link.href = '/common/css/bootstrap.min.css'\n  shadow.appendChild(link)\n  generateHomepage(subject, store, store.fetcher as Fetcher).then(homepage =>\n    shadow.appendChild(homepage)\n  )\n}\n\nexport default dashboardPane\n"],"file":"dashboardPane.js"}