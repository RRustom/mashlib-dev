{"version":3,"sources":["../../src/dashboard/homepage.ts"],"names":["generateHomepage","subject","store","fetcher","loadProfile","ownersProfile","name","getName","wrapper","document","createElement","classList","add","appendChild","createTitle","uri","createDataSection","dataSection","title","innerText","listGroup","publicDataLink","href","profileLink","profileLinkPost","pod","site","webId","load","anyValue","ns","vcard","doc","foaf","URL","host","split"],"mappings":"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","sourcesContent":["import { Fetcher, IndexedFormula, NamedNode, sym } from 'rdflib'\nimport { ns } from 'solid-ui'\n\nexport async function generateHomepage (\n  subject: NamedNode,\n  store: IndexedFormula,\n  fetcher: Fetcher\n): Promise<HTMLElement> {\n  const ownersProfile = await loadProfile(subject, fetcher)\n  const name = getName(store, ownersProfile)\n\n  const wrapper = document.createElement('div')\n  wrapper.classList.add('container')\n  wrapper.appendChild(createTitle(ownersProfile.uri, name))\n  wrapper.appendChild(createDataSection(name))\n\n  return wrapper\n}\n\nfunction createDataSection (name: string): HTMLElement {\n  const dataSection = document.createElement('section')\n\n  const title = document.createElement('h2')\n  title.innerText = 'Data'\n  dataSection.appendChild(title)\n\n  const listGroup = document.createElement('div')\n  listGroup.classList.add('list-group')\n  dataSection.appendChild(listGroup)\n\n  const publicDataLink = document.createElement('a')\n  publicDataLink.classList.add('list-group-item')\n  publicDataLink.href = '/public/'\n  publicDataLink.innerText = `View ${name}'s files`\n  listGroup.appendChild(publicDataLink)\n\n  return dataSection\n}\n\nfunction createTitle (uri: string, name: string): HTMLElement {\n  const profileLink = document.createElement('a')\n  profileLink.href = uri\n  profileLink.innerText = name\n\n  const profileLinkPost = document.createElement('span')\n  profileLinkPost.innerText = '\\'s Pod'\n\n  const title = document.createElement('h1')\n  title.appendChild(profileLink)\n  title.appendChild(profileLinkPost)\n\n  return title\n}\n\nasync function loadProfile (\n  subject: NamedNode,\n  fetcher: Fetcher\n): Promise<NamedNode> {\n  const pod = subject.site().uri\n  // TODO: This is a hack - we cannot assume that the profile is at this document, but we will live with it for now\n  const webId = sym(`${pod}profile/card#me`)\n  await fetcher.load(webId)\n  return webId\n}\n\nfunction getName (store: IndexedFormula, ownersProfile: NamedNode): string {\n  return (\n    store.anyValue(ownersProfile, ns.vcard('fn'), null, ownersProfile.doc()) ||\n    store.anyValue(ownersProfile, ns.foaf('name'), null, ownersProfile.doc()) ||\n    new URL(ownersProfile.uri).host.split('.')[0]\n  )\n}\n"],"file":"homepage.js"}